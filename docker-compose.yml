services:
  wireguard-socks5-proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: wireguard-socks5-proxy
    network_mode: host
    privileged: true
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    devices:
      - /dev/net/tun:/dev/net/tun
    volumes:
      - ./data:/app/data
      - ./config.yaml:/app/config.yaml:ro
      - /lib/modules:/lib/modules:ro
    restart: unless-stopped
    environment:
      - CONFIG_PATH=/app/config.yaml
    command: ["bun", "run", "src/index.ts"]
